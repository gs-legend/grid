/**
 * @ag-grid-enterprise/excel-export - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.0.1
 * @link http://www.ag-grid.com/
' * @license Commercial
 */

/**
 * @ag-grid-enterprise/excel-export - Advanced Data Grid / Data Table supporting Javascript / Typescript / React / Angular / Vue * @version v27.0.1
 * @link http://www.ag-grid.com/
' * @license Commercial
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t,r,n,o,a,i,s,l,p,c=require("@ag-grid-community/core"),u=require("@ag-grid-enterprise/core"),d=require("@ag-grid-community/csv-export"),m=function(){return{name:"Workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",html:"http://www.w3.org/TR/REC-html40"}}],rawMap:{xmlns:"urn:schemas-microsoft-com:office:spreadsheet"}}}},f=function(){return{name:"ExcelWorkbook",properties:{rawMap:{xmlns:"urn:schemas-microsoft-com:office:excel"}},children:[{name:"WindowHeight",textNode:"8130"},{name:"WindowWidth",textNode:"15135"},{name:"WindowHeight",textNode:"8130"},{name:"WindowTopX",textNode:"120"},{name:"WindowTopY",textNode:"45"},{name:"ProtectStructure",textNode:"False"},{name:"ProtectWindow",textNode:"False"}]}},h=function(e){return{name:"Column",properties:{prefixedAttributes:[{prefix:"ss:",map:{Width:e.width}}]}}},g=function(e){var t=e.mergeAcross,r=e.styleId,n=e.data,o={};return t&&(o.MergeAcross=t),r&&(o.StyleID=r),{name:"Cell",properties:{prefixedAttributes:[{prefix:"ss:",map:o}]},children:[{name:"Data",properties:{prefixedAttributes:[{prefix:"ss:",map:{Type:n.type}}]},textNode:n.value}]}},y=function(e){return{name:"Row",children:e.cells.map((function(e){return g(e)}))}},x=function(e){var t=e.table,r=e.name,n=t.columns,o=t.rows,a=n.map((function(e){return h(e)})),i=o.map((function(e){return y(e)}));return{name:"Worksheet",children:[{name:"Table",children:a.concat(i)}],properties:{prefixedAttributes:[{prefix:"ss:",map:{Name:r}}]}}},v=function(){return{name:"DocumentProperties",properties:{rawMap:{xmlns:"urn:schemas-microsoft-com:office:office"}},children:[{name:"Version",textNode:"12.00"}]}},w={getTemplate:function(e){var t=e.alignment;return{name:"Alignment",properties:{prefixedAttributes:[{prefix:"ss:",map:{Vertical:t.vertical,Horizontal:t.horizontal,Indent:t.indent,ReadingOrder:t.readingOrder,Rotate:t.rotate,ShrinkToFit:t.shrinkToFit,VerticalText:t.verticalText,WrapText:t.wrapText}}]}}}},b={getTemplate:function(e){var t=e.borders;return{name:"Borders",children:[t.borderBottom,t.borderLeft,t.borderRight,t.borderTop].map((function(e,t){return{name:"Border",properties:{prefixedAttributes:[{prefix:"ss:",map:{Position:0==t?"Bottom":1==t?"Left":2==t?"Right":"Top",LineStyle:e.lineStyle,Weight:e.weight,Color:e.color}}]}}}))}}},S={getTemplate:function(e){var t=e.font;return{name:"Font",properties:{prefixedAttributes:[{prefix:"ss:",map:{Bold:t.bold,FontName:t.fontName,Italic:t.italic,Color:t.color,Outline:t.outline,Shadow:t.shadow,Size:t.size,StrikeThrough:t.strikeThrough,Underline:t.underline,VerticalAlign:t.verticalAlign}},{prefix:"x:",map:{CharSet:t.charSet,Family:t.family}}]}}}},M={getTemplate:function(e){var t=e.interior;return{name:"Interior",properties:{prefixedAttributes:[{prefix:"ss:",map:{Color:t.color,Pattern:t.pattern,PatternColor:t.patternColor}}]}}}},C={getTemplate:function(e){return{name:"Protection",properties:{prefixedAttributes:[{prefix:"ss:",map:{Protected:e.protection.protected,HideFormula:e.protection.hideFormula}}]}}}},T={getTemplate:function(e){return{name:"NumberFormat",properties:{prefixedAttributes:[{prefix:"ss:",map:{Format:e.numberFormat.format}}]}}}},I=function(e){var t=e.id,r=e.name;return{name:"Style",properties:{prefixedAttributes:[{prefix:"ss:",map:{ID:t,Name:r||t}}]}}},E=function(){function e(){}return e.createExcel=function(e,t){var r=this.excelXmlHeader(),n=v(),o=f(),a=this.workbook(n,o,e,t);return""+r+d.XmlFactory.createXml(a,(function(e){return e?"1":"0"}))},e.workbook=function(e,t,r,n){var o=[e,t,this.stylesXmlElement(r)].concat(x(n));return Object.assign({},m(),{children:o})},e.excelXmlHeader=function(){return'<?xml version="1.0" ?>\n        <?mso-application progid="Excel.Sheet" ?>\n        '},e.stylesXmlElement=function(e){var t=this;return{name:"Styles",children:e?e.map((function(e){return t.styleXmlElement(e)})):[]}},e.styleXmlElement=function(e){var t=c._.compose(this.addProperty("alignment",e),this.addProperty("borders",e),this.addProperty("font",e),this.addProperty("interior",e),this.addProperty("protection",e),this.addProperty("numberFormat",e))([]);return Object.assign({},I(e),{children:t})},e.addProperty=function(e,t){return function(r){if(!t[e])return r;var n={alignment:w,borders:b,font:S,interior:M,numberFormat:T,protection:C};return r.concat(n[e].getTemplate(t))}},e.factoryMode=c.ExcelFactoryMode.SINGLE_SHEET,e}(),k={0:1,"0.00":2,"#,##0":3,"#,##0.00":4,"0%":9,"0.00%":10,"0.00E+00":11,"# ?/?":12,"# ??/??":13,"mm-dd-yy":14,"d-mmm-yy":15,"d-mmm":16,"mmm-yy":17,"h:mm AM/PM":18,"h:mm:ss AM/PM":19,"h:mm":20,"h:mm:ss":21,"m/d/yy h:mm":22,"#,##0 ;(#,##0)":37,"#,##0 ;[Red](#,##0)":38,"#,##0.00;(#,##0.00)":39,"#,##0.00;[Red](#,##0.00)":40,"mm:ss":45,"[h]:mm:ss":46,"mmss.0":47,"##0.0E+0":48,"@":49},D=function(e){return Math.ceil(9525*e)},F=function(e,t){if(t){var r,n;if("number"==typeof t)r=t;else r=t({rowIndex:e});return n=r,Math.round(72*n/96)}},A=function(e){return""+d.XmlFactory.createHeader({encoding:"UTF-8",standalone:"yes"})+d.XmlFactory.createXml(e)},N=function(e){var t=String.fromCharCode,r=Math.floor(e/26),n=e%26;return r&&26!==e?n?r<26?t(65+r-1)+t(65+n-1):N(r)+t(65+n-1):N(r-1)+"Z":t(65+e-1)},O=(e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)},function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),P=function(){return(P=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},_=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},R=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e},L=function(e){function t(t){var r=e.call(this,t)||this;return r.mixedStyles={},r.mixedStyleCounter=0,r.rows=[],r.config=Object.assign({},t),r.stylesByIds={},r.config.baseExcelStyles.forEach((function(e){r.stylesByIds[e.id]=e})),r.excelStyles=R(r.config.baseExcelStyles),r}return O(t,e),t.prototype.addCustomContent=function(e){var t=this;e.forEach((function(e){var r=t.rows.length+1;t.rows.push({height:F(r,t.config.rowHeight),cells:e.map((function(e,n){var o=t.addImage(r,t.columnsToExport[n],e.data.value),a=P({},e);return o&&(a.data={},null!=o.value?a.data.value=o.value:(a.data.type="e",a.data.value=null)),a}))})}))},t.prototype.onNewHeaderGroupingRow=function(){var e=this,t=[];return this.rows.push({cells:t,height:F(this.rows.length+1,this.config.headerRowHeight)}),{onColumn:function(r,n,o,a){var i=e.config.styleLinker(d.RowType.HEADER_GROUPING,1,"grouping-"+r,void 0,void 0);t.push(P(P({},e.createMergedCell(e.getStyleId(i),e.getDataTypeForValue("string"),r,o)),{collapsibleRanges:a}))}}},t.prototype.onNewHeaderRow=function(){return this.onNewRow(this.onNewHeaderColumn,this.config.headerRowHeight)},t.prototype.onNewBodyRow=function(){return this.onNewRow(this.onNewBodyColumn,this.config.rowHeight)},t.prototype.prepare=function(t){var r=this;e.prototype.prepare.call(this,t),this.columnsToExport=R(t),this.cols=t.map((function(e,t){return r.convertColumnToExcel(e,t)}))},t.prototype.parse=function(){for(var e=this.rows.reduce((function(e,t){return Math.max(e,t.cells.length)}),0);this.cols.length<e;)this.cols.push(this.convertColumnToExcel(null,this.cols.length+1));var t={name:this.config.sheetName,table:{columns:this.cols,rows:this.rows}};return this.createExcel(t)},t.prototype.isFormula=function(e){return null!=e&&(this.config.autoConvertFormulas&&e.toString().startsWith("="))},t.prototype.getStyleById=function(e){return null==e?null:this.stylesByIds[e]||null},t.prototype.convertColumnToExcel=function(e,t){var r=this.config.columnWidth;if(r)return"number"==typeof r?{width:r}:{width:r({column:e,index:t})};if(e){return{width:Math.max(e.getActualWidth(),75)}}return{}},t.prototype.onNewHeaderColumn=function(e,t){var r=this;return function(n,o){var a=r.extractHeaderValue(n),i=r.config.styleLinker(d.RowType.HEADER,e,a,n,void 0);t.push(r.createCell(r.getStyleId(i),r.getDataTypeForValue("string"),a))}},t.prototype.onNewRow=function(e,t){var r=[];return this.rows.push({cells:r,height:F(this.rows.length+1,t)}),{onColumn:e.bind(this,this.rows.length,r)()}},t.prototype.onNewBodyColumn=function(e,t){var r=this,n=0;return function(o,a,i){if(n>0)n-=1;else{var s=r.extractRowCellValue(o,a,e,c.Constants.EXPORT_TYPE_EXCEL,i),l=r.config.styleLinker(d.RowType.BODY,e,s,o,i),p=r.getStyleId(l),u=o.getColSpan(i),m=r.addImage(e,o,s);m?t.push(r.createCell(p,r.getDataTypeForValue(m.value),null==m.value?"":m.value)):u>1?(n=u-1,t.push(r.createMergedCell(p,r.getDataTypeForValue(s),s,u-1))):t.push(r.createCell(p,r.getDataTypeForValue(s),s))}}},t.prototype.getStyleId=function(e){if(!e||!e.length)return null;if(1===e.length)return e[0];var t=e.join("-");return this.mixedStyles[t]||this.addNewMixedStyle(e),this.mixedStyles[t].excelID},t.prototype.addNewMixedStyle=function(e){var t=this;this.mixedStyleCounter+=1;var r="mixedStyle"+this.mixedStyleCounter,n={};e.forEach((function(e){t.excelStyles.forEach((function(t){t.id===e&&c._.mergeDeep(n,c._.deepCloneObject(t))}))})),n.id=r,n.name=r;var o=e.join("-");this.mixedStyles[o]={excelID:r,key:o,result:n},this.excelStyles.push(n),this.stylesByIds[r]=n},t}(d.BaseGridSerializingSession),B=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return B(t,e),t.prototype.createExcel=function(e){return E.createExcel(this.excelStyles,e)},t.prototype.getDataTypeForValue=function(e){return c._.isNumeric(e)?"Number":"String"},t.prototype.getType=function(e,t,r){if(this.isFormula(r))return"Formula";if(t&&t.dataType)switch(t.dataType.toLocaleLowerCase()){case"string":return"Formula";case"number":return"Number";case"datetime":return"DateTime";case"error":return"Error";case"boolean":return"Boolean";default:console.warn("AG Grid: Unrecognized data type for excel export ["+t.id+".dataType="+t.dataType+"]")}return e},t.prototype.addImage=function(){},t.prototype.createCell=function(e,t,r){var n=this.getStyleById(e),o=this.getType(t,n,r)||t;return{styleId:n?e:void 0,data:{type:o,value:this.getValueTransformed(o,r)}}},t.prototype.getValueTransformed=function(e,t){var r,n=this;switch(e){case"String":return function(e){if(n.config.suppressTextAsCDATA)return c._.escapeString(e);var t=new RegExp("]]>","g");return"<![CDATA["+String(e).replace(t,"]]]]><![CDATA[>")+"]]>"}(t);case"Number":return Number(t).valueOf()+"";case"Boolean":return(r=t)&&"0"!==r&&"false"!==r?"1":"0";default:return t}},t.prototype.createMergedCell=function(e,t,r,n){return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:r},mergeAcross:n}},t}(L),z=function(e){var t=(new Date).toJSON();return{name:"cp:coreProperties",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"}}]},children:[{name:"dc:creator",textNode:e},{name:"dc:title",textNode:"Workbook"},{name:"dcterms:created",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t},{name:"dcterms:modified",properties:{rawMap:{"xsi:type":"dcterms:W3CDTF"}},textNode:t}]}},W=function(e){var t=e.name,r=e.ContentType;return{name:t,properties:{rawMap:{Extension:e.Extension,PartName:e.PartName,ContentType:r}}}},j=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},G=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(j(arguments[t]));return e},V=function(e){var t=new Array(e).fill(void 0).map((function(e,t){return{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",PartName:"/xl/worksheets/sheet"+(t+1)+".xml"}})),r=ft.worksheetImages.size,n={};ft.workbookImageIds.forEach((function(e){n[e.type]=!0}));var o=new Array(r).fill(void 0).map((function(e,t){return{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml",PartName:"/xl/drawings/drawing"+(t+1)+".xml"}})),a=Object.keys(n).map((function(e){return{name:"Default",ContentType:"image/"+e,Extension:e}}));return{name:"Types",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"}},children:G(a,[{name:"Default",Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"},{name:"Default",ContentType:"application/xml",Extension:"xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",PartName:"/xl/workbook.xml"}],t,[{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml",PartName:"/xl/theme/theme1.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",PartName:"/xl/styles.xml"},{name:"Override",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",PartName:"/xl/sharedStrings.xml"}],o,[{name:"Override",ContentType:"application/vnd.openxmlformats-package.core-properties+xml",PartName:"/docProps/core.xml"}]).map((function(e){return W(e)}))}},U=function(e,t){return{name:"xdr:"+e,children:[{name:"xdr:col",textNode:t.col.toString()},{name:"xdr:colOff",textNode:t.offsetX.toString()},{name:"xdr:row",textNode:t.row.toString()},{name:"xdr:rowOff",textNode:t.offsetY.toString()}]}},X=function(e){var t=[{name:"a:ext",properties:{rawMap:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}},children:[{name:"a16:creationId",properties:{rawMap:{id:"{822E6D20-D7BC-2841-A643-D49A6EF008A2}","xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main"}}}]}];switch(e.recolor&&e.recolor.toLowerCase()){case"grayscale":case"sepia":case"washout":t.push({name:"a:ext",properties:{rawMap:{uri:"{C183D7F6-B498-43B3-948B-1728B52AA6E4}"}},children:[{name:"adec:decorative",properties:{rawMap:{val:"0","xmlns:adec":"http://schemas.microsoft.com/office/drawing/2017/decorative"}}}]})}return{name:"a:extLst",children:t}},Z=function(e,t){return{name:"xdr:nvPicPr",children:[{name:"xdr:cNvPr",properties:{rawMap:{id:t,name:e.id,descr:null!=e.altText?e.altText:void 0}},children:[X(e)]},{name:"xdr:cNvPicPr",properties:{rawMap:{preferRelativeResize:"0"}},children:[{name:"a:picLocks"}]}]}},J=function(e){if(e.saturation||e.tint){var t=[];return e.saturation&&t.push({name:"a:satMod",properties:{rawMap:{val:1e3*e.saturation}}}),e.tint&&t.push({name:"a:tint",properties:{rawMap:{val:1e3*e.tint}}}),t}},Y=function(e,t){var r,n,o;if(e.transparency){var a=Math.min(Math.max(e.transparency,0),100);r=[{name:"a:alphaModFix",properties:{rawMap:{amt:1e5-Math.round(1e3*a)}}}]}if(e.recolor)switch(r||(r=[]),e.recolor.toLocaleLowerCase()){case"grayscale":r.push({name:"a:grayscl"});break;case"sepia":r.push((o={color:"D9C3A5",tint:50,saturation:180},{name:"a:duotone",children:[{name:"a:prstClr",properties:{rawMap:{val:(n={color:"black"}).color}},children:J(n)},{name:"a:srgbClr",properties:{rawMap:{val:o.color}},children:J(o)}]}));break;case"washout":r.push({name:"a:lum",properties:{rawMap:{bright:"70000",contrast:"-70000"}}})}return{name:"xdr:blipFill",children:[{name:"a:blip",properties:{rawMap:{cstate:"print","r:embed":"rId"+t,"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}},children:r},{name:"a:stretch",children:[{name:"a:fillRect"}]}]}},K=function(e,t){var r={name:"a:xfrm",children:[{name:"a:off",properties:{rawMap:{x:0,y:0}}},{name:"a:ext",properties:{rawMap:{cx:t.width,cy:t.height}}}]};if(e.rotation){var n=e.rotation;r.properties={rawMap:{rot:6e4*Math.min(Math.max(n,0),360)}}}return{name:"xdr:spPr",children:[r,{name:"a:prstGeom",properties:{rawMap:{prst:"rect"}},children:[{name:"a:avLst"}]}]}},q=function(e,t,r,n){return{name:"xdr:pic",children:[Z(e,t+1),Y(e,r+1),K(e,n)]}},$=function(e){var t=e.sheetIndex,r=ft.worksheetImages.get(t),n=ft.worksheetImageIds.get(t);return{name:"xdr:wsDr",properties:{rawMap:{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main","xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing"}},children:r.map((function(e,t){var r=function(e){e.fitCell=!!e.fitCell||!e.width||!e.height;var t=e.position,r=void 0===t?{}:t,n=e.fitCell,o=e.width,a=void 0===o?0:o,i=e.height,s=void 0===i?0:i,l=e.totalHeight,p=e.totalWidth,c=r.offsetX,u=void 0===c?0:c,d=r.offsetY,m=void 0===d?0:d,f=r.row,h=void 0===f?1:f,g=r.rowSpan,y=void 0===g?1:g,x=r.column,v=void 0===x?1:x,w=r.colSpan,b=void 0===w?1:w;return{from:{row:h-1,col:v-1,offsetX:D(u),offsetY:D(m)},to:{row:h-1+(n?1:y-1),col:v-1+(n?1:b-1),offsetX:D(a+u),offsetY:D(s+m)},height:D(l||s),width:D(p||a)}}(e);return{name:"xdr:twoCellAnchor",properties:{rawMap:{editAs:"absolute"}},children:[U("from",r.from),U("to",r.to),q(e,t,n.get(e.id).index,r),{name:"xdr:clientData"}]}}))}},Q=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},ee=function(e){var t=Q(e,4);return{name:"a:"+t[0],children:[{name:"a:"+t[1],properties:{rawMap:{val:t[2],lastClr:t[3]}}}]}},te=function(){return{name:"a:clrScheme",properties:{rawMap:{name:"Office"}},children:[ee(["dk1","sysClr","windowText","000000"]),ee(["lt1","sysClr","window","FFFFFF"]),ee(["dk2","srgbClr","44546A"]),ee(["lt2","srgbClr","E7E6E6"]),ee(["accent1","srgbClr","4472C4"]),ee(["accent2","srgbClr","ED7D31"]),ee(["accent3","srgbClr","A5A5A5"]),ee(["accent4","srgbClr","FFC000"]),ee(["accent5","srgbClr","5B9BD5"]),ee(["accent6","srgbClr","70AD47"]),ee(["hlink","srgbClr","0563C1"]),ee(["folHlink","srgbClr","954F72"])]}},re=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},ne=function(e){var t=re(e,4),r=t[0],n=t[1];return{name:"a:"+r,properties:{rawMap:{script:t[2],typeface:n,panose:t[3]}}}},oe=function(){var e=c._.utf8_encode;return{name:"a:fontScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:majorFont",children:[ne(["latin","Calibri Light",void 0,"020F0302020204030204"]),ne(["ea",""]),ne(["cs",""]),ne(["font",e("\u6e38\u30b4\u30b7\u30c3\u30af Light"),"Jpan"]),ne(["font",e("\ub9d1\uc740 \uace0\ub515"),"Hang"]),ne(["font",e("\u7b49\u7ebf Light"),"Hans"]),ne(["font",e("\u65b0\u7d30\u660e\u9ad4"),"Hant"]),ne(["font","Times New Roman","Arab"]),ne(["font","Times New Roman","Hebr"]),ne(["font","Tahoma","Thai"]),ne(["font","Nyala","Ethi"]),ne(["font","Vrinda","Beng"]),ne(["font","Shruti","Gujr"]),ne(["font","MoolBoran","Khmr"]),ne(["font","Tunga","Knda"]),ne(["font","Raavi","Guru"]),ne(["font","Euphemia","Cans"]),ne(["font","Plantagenet Cherokee","Cher"]),ne(["font","Microsoft Yi Baiti","Yiii"]),ne(["font","Microsoft Himalaya","Tibt"]),ne(["font","MV Boli","Thaa"]),ne(["font","Mangal","Deva"]),ne(["font","Gautami","Telu"]),ne(["font","Latha","Taml"]),ne(["font","Estrangelo Edessa","Syrc"]),ne(["font","Kalinga","Orya"]),ne(["font","Kartika","Mlym"]),ne(["font","DokChampa","Laoo"]),ne(["font","Iskoola Pota","Sinh"]),ne(["font","Mongolian Baiti","Mong"]),ne(["font","Times New Roman","Viet"]),ne(["font","Microsoft Uighur","Uigh"]),ne(["font","Sylfaen","Geor"]),ne(["font","Arial","Armn"]),ne(["font","Leelawadee UI","Bugi"]),ne(["font","Microsoft JhengHei","Bopo"]),ne(["font","Javanese Text","Java"]),ne(["font","Segoe UI","Lisu"]),ne(["font","Myanmar Text","Mymr"]),ne(["font","Ebrima","Nkoo"]),ne(["font","Nirmala UI","Olck"]),ne(["font","Ebrima","Osma"]),ne(["font","Phagspa","Phag"]),ne(["font","Estrangelo Edessa","Syrn"]),ne(["font","Estrangelo Edessa","Syrj"]),ne(["font","Estrangelo Edessa","Syre"]),ne(["font","Nirmala UI","Sora"]),ne(["font","Microsoft Tai Le","Tale"]),ne(["font","Microsoft New Tai Lue","Talu"]),ne(["font","Ebrima","Tfng"])]},{name:"a:minorFont",children:[ne(["latin","Calibri",void 0,"020F0502020204030204"]),ne(["ea",""]),ne(["cs",""]),ne(["font",e("\u6e38\u30b4\u30b7\u30c3\u30af"),"Jpan"]),ne(["font",e("\ub9d1\uc740 \uace0\ub515"),"Hang"]),ne(["font",e("\u7b49\u7ebf"),"Hans"]),ne(["font",e("\u65b0\u7d30\u660e\u9ad4"),"Hant"]),ne(["font","Arial","Arab"]),ne(["font","Arial","Hebr"]),ne(["font","Tahoma","Thai"]),ne(["font","Nyala","Ethi"]),ne(["font","Vrinda","Beng"]),ne(["font","Shruti","Gujr"]),ne(["font","DaunPenh","Khmr"]),ne(["font","Tunga","Knda"]),ne(["font","Raavi","Guru"]),ne(["font","Euphemia","Cans"]),ne(["font","Plantagenet Cherokee","Cher"]),ne(["font","Microsoft Yi Baiti","Yiii"]),ne(["font","Microsoft Himalaya","Tibt"]),ne(["font","MV Boli","Thaa"]),ne(["font","Mangal","Deva"]),ne(["font","Gautami","Telu"]),ne(["font","Latha","Taml"]),ne(["font","Estrangelo Edessa","Syrc"]),ne(["font","Kalinga","Orya"]),ne(["font","Kartika","Mlym"]),ne(["font","DokChampa","Laoo"]),ne(["font","Iskoola Pota","Sinh"]),ne(["font","Mongolian Baiti","Mong"]),ne(["font","Arial","Viet"]),ne(["font","Microsoft Uighur","Uigh"]),ne(["font","Sylfaen","Geor"]),ne(["font","Arial","Armn"]),ne(["font","Leelawadee UI","Bugi"]),ne(["font","Microsoft JhengHei","Bopo"]),ne(["font","Javanese Text","Java"]),ne(["font","Segoe UI","Lisu"]),ne(["font","Myanmar Text","Mymr"]),ne(["font","Ebrima","Nkoo"]),ne(["font","Nirmala UI","Olck"]),ne(["font","Ebrima","Osma"]),ne(["font","Phagspa","Phag"]),ne(["font","Estrangelo Edessa","Syrn"]),ne(["font","Estrangelo Edessa","Syrj"]),ne(["font","Estrangelo Edessa","Syre"]),ne(["font","Nirmala UI","Sora"]),ne(["font","Microsoft Tai Le","Tale"]),ne(["font","Microsoft New Tai Lue","Talu"]),ne(["font","Ebrima","Tfng"])]}]}},ae=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},ie=function(e,t,r){return{name:"a:"+e,properties:{rawMap:{val:t}},children:r}},se=function(e){var t=ae(e,6),r=t[0],n=t[1],o=t[2],a=t[3],i=t[4],s=t[5],l=[];return l.push(ie("satMod",o)),a&&l.push(ie("lumMod",a)),i&&l.push(ie("tint",i)),s&&l.push(ie("shade",s)),{name:"a:gs",properties:{rawMap:{pos:r}},children:[{name:"a:schemeClr",properties:{rawMap:{val:n}},children:l}]}},le=function(e,t){return{name:"a:solidFill",children:[ie("schemeClr",e,t)]}},pe=function(e){var t=ae(e,5),r=t[0],n=t[1],o=t[2],a=t[3],i=t[4],s=ae(i,2),l=s[0],p=s[1];return{name:"a:gradFill",properties:{rawMap:{rotWithShape:r}},children:[{name:"a:gsLst",children:[se(n),se(o),se(a)]},{name:"a:lin",properties:{rawMap:{ang:l,scaled:p}}}]}},ce=function(e){var t=ae(e,4);return{name:"a:ln",properties:{rawMap:{w:t[0],cap:t[1],cmpd:t[2],algn:t[3]}},children:[le("phClr"),ie("prstDash","solid"),{name:"a:miter",properties:{rawMap:{lim:"800000"}}}]}},ue=function(e){var t=[];if(e){var r=ae(e,5),n=r[0],o=r[1],a=r[2],i=r[3],s=r[4];t.push({name:"a:outerShdw",properties:{rawMap:{blurRad:n,dist:o,dir:a,algn:i,rotWithShape:s}},children:[ie("srgbClr","000000",[ie("alpha","63000")])]})}return{name:"a:effectStyle",children:[Object.assign({},{name:"a:effectLst"},t.length?{children:t}:{})]}},de=function(){return{name:"a:fmtScheme",properties:{rawMap:{name:"Office"}},children:[{name:"a:fillStyleLst",children:[le("phClr"),pe(["1",["0","phClr","105000","110000","67000"],["50000","phClr","103000","105000","73000"],["100000","phClr","109000","105000","81000"],["5400000","0"]]),pe(["1",["0","phClr","103000","102000","94000"],["50000","phClr","110000","100000",void 0,"100000"],["100000","phClr","120000","99000",void 0,"78000"],["5400000","0"]])]},{name:"a:lnStyleLst",children:[ce(["6350","flat","sng","ctr"]),ce(["12700","flat","sng","ctr"]),ce(["19050","flat","sng","ctr"])]},{name:"a:effectStyleLst",children:[ue(),ue(),ue(["57150","19050","5400000","ctr","0"])]},{name:"a:bgFillStyleLst",children:[le("phClr"),le("phClr",[ie("tint","95000"),ie("satMod","170000")]),pe(["1",["0","phClr","150000","102000","93000","98000"],["50000","phClr","130000","103000","98000","90000"],["100000","phClr","120000",void 0,void 0,"63000"],["5400000","0"]])]}]}},me=function(){return{name:"a:themeElements",children:[te(),oe(),de()]}},fe=function(){return{name:"a:theme",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{a:"http://schemas.openxmlformats.org/drawingml/2006/main"}}],rawMap:{name:"Office Theme"}},children:[me(),{name:"a:objectDefaults"},{name:"a:extraClrSchemeLst"}]}},he=function(e){return{name:"sst",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:e.size,uniqueCount:e.size}},children:(t=e,r=[],t.forEach((function(e,t){var n=t.toString(),o={name:"t",textNode:c._.utf8_encode(c._.escapeString(n))};n.trim().length!==n.length&&(o.properties={rawMap:{"xml:space":"preserve"}}),r.push({name:"si",children:[o]})})),r)};var t,r},ge=function(e){return{name:"numFmt",properties:{rawMap:{formatCode:e.formatCode,numFmtId:e.numFmtId}}}},ye=function(e){return{name:"numFmts",properties:{rawMap:{count:e.length}},children:e.map((function(e){return ge(e)}))}},xe=function(e){var t=e.size,r=e.colorTheme,n=e.color,o=void 0===n?"FF000000":n,a=e.fontName,i=void 0===a?"Calibri":a,s=e.family,l=e.scheme,p=e.italic,c=e.bold,u=e.strikeThrough,d=e.outline,m=e.shadow,f=e.underline,h=e.verticalAlign,g=[{name:"sz",properties:{rawMap:{val:t}}},{name:"color",properties:{rawMap:{theme:r,rgb:o}}},{name:"name",properties:{rawMap:{val:i}}}];return s&&g.push({name:"family",properties:{rawMap:{val:s}}}),l&&g.push({name:"scheme",properties:{rawMap:{val:l}}}),p&&g.push({name:"i"}),c&&g.push({name:"b"}),u&&g.push({name:"strike"}),d&&g.push({name:"outline"}),m&&g.push({name:"shadow"}),f&&g.push({name:"u",properties:{rawMap:{val:f}}}),h&&g.push({name:"vertAlign",properties:{rawMap:{val:h}}}),{name:"font",children:g}},ve=function(e){return{name:"fonts",properties:{rawMap:{count:e.length}},children:e.map((function(e){return xe(e)}))}},we=function(e){var t=e.patternType,r=e.fgTheme,n=e.fgTint,o=e.fgRgb,a=e.bgRgb,i=e.bgIndexed,s={name:"patternFill",properties:{rawMap:{patternType:t}}};return(r||n||o)&&(s.children=[{name:"fgColor",properties:{rawMap:{theme:r,tint:n,rgb:o}}}]),(i||a)&&(s.children||(s.children=[]),s.children.push({name:"bgColor",properties:{rawMap:{indexed:i,rgb:a}}})),{name:"fill",children:[s]}},be=function(e){return{name:"fills",properties:{rawMap:{count:e.length}},children:e.map((function(e){return we(e)}))}},Se={None:"None",Dot:"Dotted",Dash:"Dashed",Double:"Double",DashDot:"DashDot",DashDotDot:"DashDotDot",SlantDashDot:"SlantDashDot"},Me=["Dashed","DashDot","DashDotDot"],Ce={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinDiagStripe:"lightUp",ThinHorzCross:"lightGrid",ThinDiagCross:"lightTrellis",Gray125:"gray125",Gray0625:"gray0625"},Te={Automatic:"general",Left:"left",Center:"center",Right:"right",Fill:"fill",Justify:"justify",CenterAcrossSelection:"centerContinuous",Distributed:"distributed",JustifyDistributed:"justify"},Ie={Automatic:void 0,Top:"top",Bottom:"bottom",Center:"center",Justify:"justify",Distributed:"distributed",JustifyDistributed:"justify"},Ee=function(e){return null==e?e:("#"===e.charAt(0)&&(e=e.substr(1)),6===e.length?"FF"+e:e)},ke=function(e,t){if(!e)return"thin";var r=function(e){switch(e){case 1:return"thin";case 2:return"medium";case 3:return"thick";default:return"hair"}}(t),n=Se[e];return"Continuous"===e?r:"medium"===r&&-1!==Me.indexOf(n)?"medium"+n:n.charAt(0).toLowerCase()+n.substr(1)},De=function(e){return Te[e]||"general"},Fe=function(e){return Ie[e]||void 0},Ae=function(e){return{name:"color",properties:{rawMap:{rgb:Ee(e||"#000000")}}}},Ne=function(e){var t=e.left,r=e.right,n=e.top,o=e.bottom,a=e.diagonal,i=t?[Ae(t.color)]:void 0,s=r?[Ae(r.color)]:void 0,l=n?[Ae(n.color)]:void 0,p=o?[Ae(o.color)]:void 0,c=a?[Ae(a.color)]:void 0;return{name:"border",children:[{name:"left",properties:{rawMap:{style:t&&t.style}},children:i},{name:"right",properties:{rawMap:{style:r&&r.style}},children:s},{name:"top",properties:{rawMap:{style:n&&n.style}},children:l},{name:"bottom",properties:{rawMap:{style:o&&o.style}},children:p},{name:"diagonal",properties:{rawMap:{style:a&&a.style}},children:c}]}},Oe=function(e){return{name:"borders",properties:{rawMap:{count:e.length}},children:e.map((function(e){return Ne(e)}))}},Pe=function(e){var t=["Context","LeftToRight","RightToLeft"].indexOf(e);return Math.max(t,0)},_e=function(e){var t=e.horizontal,r=e.indent,n=e.readingOrder,o=e.rotate,a=e.shrinkToFit,i=e.vertical,s=e.wrapText;return{name:"alignment",properties:{rawMap:{horizontal:t&&De(t),indent:r,readingOrder:n&&Pe(n),textRotation:o,shrinkToFit:a,vertical:i&&Fe(i),wrapText:s}}}},Re=function(e){var t=!1===e.protected?0:1;return{name:"protection",properties:{rawMap:{hidden:!0===e.hideFormula?1:0,locked:t}}}},Le=function(e){var t=e.alignment,r=e.borderId,n=e.fillId,o=e.fontId,a=e.numFmtId,i=e.protection,s=e.xfId,l=[];return t&&l.push(_e(t)),i&&l.push(Re(i)),{name:"xf",properties:{rawMap:{applyAlignment:t?1:void 0,applyProtection:i?1:void 0,applyBorder:r?1:void 0,applyFill:n?1:void 0,borderId:r,fillId:n,applyFont:o?1:void 0,fontId:o,applyNumberFormat:a?1:void 0,numFmtId:a,xfId:s}},children:l.length?l:void 0}},Be=function(e){return{name:"cellStyleXfs",properties:{rawMap:{count:e.length}},children:e.map((function(e){return Le(e)}))}},He=function(e){return{name:"cellXfs",properties:{rawMap:{count:e.length}},children:e.map((function(e){return Le(e)}))}},ze=function(e){return{name:"cellStyle",properties:{rawMap:{builtinId:e.builtinId,name:e.name,xfId:e.xfId}}}},We=function(e){return{name:"cellStyles",properties:{rawMap:{count:e.length}},children:e.map((function(e){return ze(e)}))}},je=function(){return(je=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ge=function(e,t){return-1!==e.indexOf("mixedStyle")&&t>1&&(e+="_"+t),e},Ve=function(){t={base:0},r=[],n=[{fontName:"Calibri",colorTheme:"1",family:"2",scheme:"minor"}],o=[{patternType:"none"},{patternType:"gray125"}],a=[{left:void 0,right:void 0,top:void 0,bottom:void 0,diagonal:void 0}],i=[{borderId:0,fillId:0,fontId:0,numFmtId:0}],s=[{borderId:0,fillId:0,fontId:0,numFmtId:0,xfId:0}],l=[{builtinId:0,name:"Normal",xfId:0}]},Ue=function(e){var t,r=(t=e.pattern)?Ce[t]||t:"none",n=Ee(e.color),a=Ee(e.patternColor),i=o.findIndex((function(e){var t=e.patternType,o=e.fgRgb,i=e.bgRgb;return t==r&&o==n&&i==a}));return-1===i&&(i=o.length,o.push({patternType:r,fgRgb:n,bgRgb:a})),i},Xe=function(e){var t=e.fontName,r=void 0===t?"Calibri":t,o=e.color,a=e.size,i=e.bold,s=e.italic,l=e.outline,p=e.shadow,u=e.strikeThrough,d=e.underline,m=e.family,f=e.verticalAlign,h=r?c._.utf8_encode(r):r,g=Ee(o),y=function(e){if(void 0!==e){var t=["Automatic","Roman","Swiss","Modern","Script","Decorative"].indexOf(e||"Automatic");return Math.max(t,0)}}(m),x=d?d.toLocaleLowerCase():void 0,v=f?f.toLocaleLowerCase():void 0,w=n.findIndex((function(e){return e.fontName==h&&e.color==g&&e.size==a&&e.bold==i&&e.italic==s&&e.outline==l&&e.shadow==p&&e.strikeThrough==u&&e.underline==x&&e.verticalAlign==v&&e.family==y}));return-1===w&&(w=n.length,n.push({fontName:h,color:g,size:a,bold:i,italic:s,outline:l,shadow:p,strikeThrough:u,underline:x,verticalAlign:v,family:null!=y?y.toString():void 0})),w},Ze=function(e){var n=e.alignment,o=e.borders,i=e.font,l=e.interior,u=e.numberFormat,d=e.protection,m=e.id,f=0,h=0,g=0,y=0;m&&(m=Ge(m,p),null==t[m]&&(l&&(f=Ue(l)),o&&(h=function(e){var t,r,n,o,i,s,l,p,c=e.borderBottom,u=e.borderTop,d=e.borderLeft,m=e.borderRight;d&&(n=ke(d.lineStyle,d.weight),l=Ee(d.color)),m&&(o=ke(m.lineStyle,m.weight),p=Ee(m.color)),c&&(t=ke(c.lineStyle,c.weight),i=Ee(c.color)),u&&(r=ke(u.lineStyle,u.weight),s=Ee(u.color));var f=a.findIndex((function(e){var a=e.left,c=e.right,u=e.top,d=e.bottom;if(!a&&(n||l))return!1;if(!c&&(o||p))return!1;if(!u&&(r||s))return!1;if(!d&&(t||i))return!1;var m=a||{},f=m.style,h=m.color,g=c||{},y=g.style,x=g.color,v=u||{},w=v.style,b=v.color,S=d||{},M=S.style,C=S.color;return f==n&&h==l&&(y==o&&x==p&&(w==r&&b==s&&(M==t&&C==i)))}));return-1===f&&(f=a.length,a.push({left:{style:n,color:l},right:{style:o,color:p},top:{style:r,color:s},bottom:{style:t,color:i},diagonal:{style:void 0,color:void 0}})),f}(o)),i&&(g=Xe(i)),u&&(y=function(e){if(e=c._.utf8_encode(e),k[e])return k[e];var t=r.findIndex((function(t){return t.formatCode===e}));return-1===t?(t=r.length+164,r.push({formatCode:e,numFmtId:t})):t=r[t].numFmtId,t}(u.format)),t[m]=s.length,s.push({alignment:n,borderId:h||0,fillId:f||0,fontId:g||0,numFmtId:y||0,protection:d,xfId:0})))},Je=function(e){var t=ye(r),p=ve(n.map((function(t){return je(je({},t),{size:null!=t.size?t.size:e})}))),c=be(o),u=Oe(a),d=Be(i),m=He(s),f=We(l);return Ve(),{name:"styleSheet",properties:{rawMap:{"mc:Ignorable":"x14ac x16r2 xr",xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"}},children:[t,p,c,u,d,m,f,{name:"tableStyles",properties:{rawMap:{count:0,defaultPivotStyle:"PivotStyleLight16",defaultTableStyle:"TableStyleMedium2"}}}]}},Ye=function(e,r){return t[Ge(e,r)]||0},Ke=function(e,t){var r=(t+1).toString();return{name:"sheet",properties:{rawMap:{name:e,sheetId:r,"r:id":"rId"+r}}}},qe=function(e){return{name:"sheets",children:e.map((function(e,t){return Ke(e,t)}))}},$e=function(e){return{name:"workbook",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:[qe(e)]}},Qe=function(e){var t=e.min,r=e.max,n=e.outlineLevel,o=e.s,a=e.width,i=e.hidden,s=e.bestFit,l=1,p="0";return a>1&&(l=function(e){return Math.ceil((e-12)/7+1)}(a),p="1"),{name:"col",properties:{rawMap:{min:t,max:r,outlineLevel:null!=n?n:void 0,width:l,style:o,hidden:i?"1":"0",bestFit:s?"1":"0",customWidth:p}}}},et=function(e,t,r){var n=e.ref,o=e.data,a=e.styleId,i=o.type,s=o.value,l=i;"f"===i?l="str":i.charAt(0)===i.charAt(0).toUpperCase()&&(l=function(e){var t=e.charAt(0).toLowerCase();return"s"===t?"inlineStr":t}(i));var p,u={name:"c",properties:{rawMap:{r:n,t:"empty"===l?void 0:l,s:a?Ye(a,r):void 0}}};return"empty"===l?u:(p="str"===l&&"f"===i?[{name:"f",textNode:c._.escapeString(c._.utf8_encode(s))}]:"inlineStr"===l?[{name:"is",children:[{name:"t",textNode:c._.escapeString(c._.utf8_encode(s))}]}]:[{name:"v",textNode:s}],Object.assign({},u,{children:p}))},tt=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},rt=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(tt(arguments[t]));return e},nt=function(e){return""!==e.data.value||void 0!==e.styleId},ot=function(e,t,r){var n=e.index,o=e.collapsed,a=e.hidden,i=e.height,s=e.s,l=e.cells,p=void 0===l?[]:l;return function(e,t){for(var r=[],n=0,o=0;o<e.length;o++){(i=e[o]).mergeAcross&&(r.push({pos:o,excelPos:n}),n+=i.mergeAcross),n++}if(r.length)for(o=r.length-1;o>=0;o--){for(var a=[],i=e[r[o].pos],s=1;s<=i.mergeAcross;s++)a.push({ref:""+N(r[o].excelPos+1+s)+(t+1),styleId:i.styleId,data:{type:"empty",value:null}});a.length&&e.splice.apply(e,rt([r[o].pos+1,0],a))}}(p,t),{name:"row",properties:{rawMap:{r:n,collapsed:o,hidden:a?"1":"0",ht:i,customHeight:null!=i?"1":"0",s:s,customFormat:null!=s?"1":"0"}},children:p.filter(nt).map((function(e,t){return et(e,t,r)}))}},at=function(e){return{name:"mergeCell",properties:{rawMap:{ref:e}}}},it=function(e){if(null==e)return 1;var t=["Letter","Letter Small","Tabloid","Ledger","Legal","Statement","Executive","A3","A4","A4 Small","A5","A6","B4","B5","Folio","Envelope","Envelope DL","Envelope C5","Envelope B5","Envelope C3","Envelope C4","Envelope C6","Envelope Monarch","Japanese Postcard","Japanese Double Postcard"].indexOf(e);return-1===t?1:t+1},st=function(e){return e.reduce((function(e,t){var r,n;return""+function(e,t){return t?(e+="&amp;&quot;",e+=t.fontName||"Calibri",t.bold!==t.italic?e+=t.bold?",Bold":",Italic":t.bold?e+=",Bold Italic":e+=",Regular",e+="&quot;",t.size&&(e+="&amp;"+t.size),t.strikeThrough&&(e+="&amp;S"),t.underline&&(e+="&amp;"+("Double"===t.underline?"E":"U")),t.color&&(e+="&amp;K"+t.color.replace("#","").toUpperCase()),e):e}(e+"&amp;"+("Center"===(r=t.position)?"C":"Right"===r?"R":"L"),t.font)+c._.escapeString((n=t.value,c._.iterateObject({"&[Page]":"&P","&[Pages]":"&N","&[Date]":"&D","&[Time]":"&T","&[Tab]":"&A","&[Path]":"&Z","&[File]":"&F"},(function(e,t){n=n.replace(e,t)})),n))}),"")},lt=function(e){var t=[];return["all","first","even"].forEach((function(r){var n=e[r],o="all"===r?"odd":r;n&&(n.header||n.footer)&&c._.iterateObject(n,(function(e,r){var n=""+e.charAt(0).toUpperCase()+e.slice(1);r&&t.push({name:""+o+n,properties:{rawMap:{"xml:space":"preserve"}},textNode:st(r)})}))})),t},pt=function(e){var t,r=e.worksheet,n=e.currentSheet,o=e.margins,a=void 0===o?{}:o,i=e.pageSetup,s=e.headerFooterConfig,l=r.table,p=l.rows,u=l.columns,d=u&&u.length?function(e,t){var r=[],n=[];e.forEach((function(e,o){var a,i=e.cells,s=0;e.index=o+1,i.forEach((function(e,i){var l=i+s+1,p=N(l),c=o+1;if(e.mergeAcross){s+=e.mergeAcross;var u=N(i+s+1);r.push(""+p+c+":"+u+c)}t[l-1]||(t[l-1]={});var d=e.collapsibleRanges;d&&d.forEach((function(e){n.push([l+e[0],l+e[1]])})),(a=t[l-1]).min=l,a.max=l,e.ref=""+p+c}))})),n.sort((function(e,t){return e[0]!==t[0]?e[0]-t[0]:t[1]-e[1]}));var o=new Map,a=new Map;return n.filter((function(e){var t=e.toString();return!o.get(t)&&(o.set(t,!0),!0)})).forEach((function(e){var r=t.find((function(t){return t.min==e[0]&&t.max==e[1]})),n=a.get(e[0]);t.push({min:e[0],max:e[1],outlineLevel:n||1,width:(r||{width:100}).width}),a.set(e[0],(n||0)+1)})),r}(p,u):[];return{name:"worksheet",properties:{prefixedAttributes:[{prefix:"xmlns:",map:{r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"}}],rawMap:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},children:c._.compose(function(e){return function(t){return e.length&&t.push({name:"cols",children:e.map((function(e){return Qe(e)}))}),t}}(u),function(e,t){return function(r){return e.length&&r.push({name:"sheetData",children:e.map((function(e,r){return ot(e,r,t)}))}),r}}(p,n+1),(t=d,function(e){return t.length&&e.push({name:"mergeCells",properties:{rawMap:{count:t.length}},children:t.map((function(e){return at(e)}))}),e}),function(e){return function(t){var r=e.top,n=void 0===r?.75:r,o=e.right,a=void 0===o?.7:o,i=e.bottom,s=void 0===i?.75:i,l=e.left,p=void 0===l?.7:l,c=e.header,u=void 0===c?.3:c,d=e.footer,m=void 0===d?.3:d;return t.push({name:"pageMargins",properties:{rawMap:{bottom:s,footer:m,header:u,left:p,right:a,top:n}}}),t}}(a),function(e){return function(t){var r;return e&&t.push({name:"pageSetup",properties:{rawMap:{horizontalDpi:0,verticalDpi:0,orientation:(r=e.orientation,!r||"Portrait"!==r&&"Landscape"!==r?"portrait":r.toLocaleLowerCase()),paperSize:it(e.pageSize)}}}),t}}(i),function(e){return function(t){if(!e)return t;var r=null!=e.first?1:0,n=null!=e.even?1:0;return t.push({name:"headerFooter",properties:{rawMap:{differentFirst:r,differentOddEven:n}},children:lt(e)}),t}}(s),function(e){return function(t){return ft.worksheetImages.get(e)&&t.push({name:"drawing",properties:{rawMap:{"r:id":"rId1"}}}),t}}(n))([])}},ct=function(e){return{name:"Relationship",properties:{rawMap:{Id:e.Id,Type:e.Type,Target:e.Target}}}},ut=function(e){return{name:"Relationships",properties:{rawMap:{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}},children:e.map((function(e){return ct(e)}))}},dt=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i},mt=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(dt(arguments[t]));return e},ft=function(){function e(){}return e.createExcel=function(e,t,r,n,o){return this.addSheetName(t),function(e,t){1===(p=t)&&Ve(),e.forEach(Ze)}(e,this.sheetNames.length),this.createWorksheet(t,r,n,o)},e.buildImageMap=function(e,t,r,n,o){var a=this.sheetNames.length,i=this.images.get(e.id);e.position&&e.position.row&&e.position.column||(e.position||(e.position={}),e.position=Object.assign({},e.position,{row:t,column:n.indexOf(r)+1}));var s=e;if(function(e,t){var r=e.position,n=r.colSpan,o=r.column;if(e.width)if(n)for(var a=t.slice(o-1,o+n-1),i=0,s=0;s<a.length;s++){var l=a[s].getActualWidth();if(e.width<i+l){e.position.colSpan=s+1,e.totalWidth=e.width,e.width=e.totalWidth-i;break}i+=l}else e.totalWidth=e.width}(s,n),function(e,t){var r,n=e.position,o=n.rowSpan,a=n.row;if(e.height)if(o)for(var i=0,s=0,l=a;l<a+o;l++){var p=(r=F(l,t)||20,Math.round(96*r/72));if(e.height<i+p){e.position.rowSpan=s+1,e.totalHeight=e.height,e.height=e.totalHeight-i;break}i+=p,s++}else e.totalHeight=e.height}(s,o),i){var l=i.find((function(e){return e.sheetId===a}));l?l.image.push(s):i.push({sheetId:a,image:[s]})}else this.images.set(s.id,[{sheetId:a,image:[s]}]),this.workbookImageIds.set(s.id,{type:s.imageType,index:this.workbookImageIds.size});this.buildSheetImageMap(a,s)},e.buildSheetImageMap=function(e,t){var r=this.worksheetImageIds.get(e);r||(r=new Map,this.worksheetImageIds.set(e,r));var n=this.worksheetImages.get(e);n?(n.push(t),r.get(t.id)||r.set(t.id,{index:r.size,type:t.imageType})):(this.worksheetImages.set(e,[t]),r.set(t.id,{index:0,type:t.imageType}))},e.addSheetName=function(e){for(var t=e.name,r="";-1!==this.sheetNames.indexOf(t+r);)if(""===r)r="_1";else{var n=parseInt(r.slice(1),10);r="_"+(n+1)}e.name+=r,this.sheetNames.push(e.name)},e.getStringPosition=function(e){return this.sharedStrings.has(e)?this.sharedStrings.get(e):(this.sharedStrings.set(e,this.sharedStrings.size),this.sharedStrings.size-1)},e.resetFactory=function(){this.sharedStrings=new Map,this.images=new Map,this.worksheetImages=new Map,this.workbookImageIds=new Map,this.worksheetImageIds=new Map,this.sheetNames=[],this.factoryMode=c.ExcelFactoryMode.SINGLE_SHEET},e.createWorkbook=function(){return A($e(this.sheetNames))},e.createStylesheet=function(e){return A(Je(e))},e.createSharedStrings=function(){return A(he(this.sharedStrings))},e.createCore=function(e){return A(z(e))},e.createContentTypes=function(e){return A(V(e))},e.createRels=function(){var e=ut([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Target:"xl/workbook.xml"},{Id:"rId2",Type:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",Target:"docProps/core.xml"}]);return A(e)},e.createTheme=function(){return A(fe())},e.createWorkbookRels=function(e){var t=new Array(e).fill(void 0).map((function(e,t){return{Id:"rId"+(t+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",Target:"worksheets/sheet"+(t+1)+".xml"}})),r=ut(mt(t,[{Id:"rId"+(e+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Target:"theme/theme1.xml"},{Id:"rId"+(e+2),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Target:"styles.xml"},{Id:"rId"+(e+3),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Target:"sharedStrings.xml"}]));return A(r)},e.createDrawing=function(e){return A($({sheetIndex:e}))},e.createDrawingRel=function(e){var t=this,r=this.worksheetImageIds.get(e),n=[];return r.forEach((function(e,r){n.push({Id:"rId"+(e.index+1),Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:"../media/image"+(t.workbookImageIds.get(r).index+1)+"."+e.type})})),A(ut(n))},e.createWorksheetDrawingRel=function(e){var t=ut([{Id:"rId1",Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:"../drawings/drawing"+(e+1)+".xml"}]);return A(t)},e.createWorksheet=function(e,t,r,n){return A(pt({worksheet:e,currentSheet:this.sheetNames.length-1,margins:t,pageSetup:r,headerFooterConfig:n}))},e.sharedStrings=new Map,e.sheetNames=[],e.images=new Map,e.worksheetImages=new Map,e.workbookImageIds=new Map,e.worksheetImageIds=new Map,e.factoryMode=c.ExcelFactoryMode.SINGLE_SHEET,e}(),ht=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ht(t,e),t.prototype.createExcel=function(e){var t=this.excelStyles,r=this.config,n=r.margins,o=r.pageSetup,a=r.headerFooterConfig;return ft.createExcel(t,e,n,o,a)},t.prototype.getDataTypeForValue=function(e){return void 0===e?"empty":c._.isNumeric(e)?"n":"s"},t.prototype.getType=function(e,t,r){if(this.isFormula(r))return"f";if(t&&t.dataType)switch(t.dataType.toLocaleLowerCase()){case"formula":return"f";case"string":return"s";case"number":return"n";case"datetime":return"d";case"error":return"e";case"boolean":return"b";default:console.warn("AG Grid: Unrecognized data type for excel export ["+t.id+".dataType="+t.dataType+"]")}return e},t.prototype.addImage=function(e,t,r){if(this.config.addImageToCell){var n=this.config.addImageToCell(e,t,r);if(n)return ft.buildImageMap(n.image,e,t,this.columnsToExport,this.config.rowHeight),n}},t.prototype.createCell=function(e,t,r){var n=this.getStyleById(e),o=this.getType(t,n,r)||t;return{styleId:n?e:void 0,data:{type:o,value:this.getCellValue(o,r)}}},t.prototype.createMergedCell=function(e,t,r,n){var o=null==r?"":r;return{styleId:this.getStyleById(e)?e:void 0,data:{type:t,value:"s"===t?ft.getStringPosition(o).toString():r},mergeAcross:n}},t.prototype.getCellValue=function(e,t){if(null==t)return ft.getStringPosition("").toString();switch(e){case"s":return""===t?"":ft.getStringPosition(t).toString();case"f":return t.slice(1);case"n":return Number(t).toString();default:return t}},t}(L),yt=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),xt=function(){return(xt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},vt=function(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},wt=function(e){var t=e.data,r=e.fontSize,n=void 0===r?11:r,o=e.author,a=void 0===o?"AG Grid":o,i=ft.images.size>0;if(d.ZipContainer.addFolders(["_rels/","docProps/","xl/","xl/theme/","xl/_rels/","xl/worksheets/"]),i){d.ZipContainer.addFolders(["xl/worksheets/_rels","xl/drawings/","xl/drawings/_rels","xl/media/"]);var s=0;ft.images.forEach((function(e){var t=e[0].image[0],r=t.imageType;d.ZipContainer.addFile("xl/media/image"+ ++s+"."+r,t.base64,!0)}))}if(!t||0===t.length)return console.warn("AG Grid: Invalid params supplied to getMultipleSheetsAsExcel() - `ExcelExportParams.data` is empty."),void ft.resetFactory();var l=t.length,p=0;t.forEach((function(e,t){d.ZipContainer.addFile("xl/worksheets/sheet"+(t+1)+".xml",e),i&&ft.worksheetImages.get(t)&&St(t,p++)})),d.ZipContainer.addFile("xl/workbook.xml",ft.createWorkbook()),d.ZipContainer.addFile("xl/styles.xml",ft.createStylesheet(n)),d.ZipContainer.addFile("xl/sharedStrings.xml",ft.createSharedStrings()),d.ZipContainer.addFile("xl/theme/theme1.xml",ft.createTheme()),d.ZipContainer.addFile("xl/_rels/workbook.xml.rels",ft.createWorkbookRels(l)),d.ZipContainer.addFile("docProps/core.xml",ft.createCore(a)),d.ZipContainer.addFile("[Content_Types].xml",ft.createContentTypes(l)),d.ZipContainer.addFile("_rels/.rels",ft.createRels()),ft.resetFactory();var c=e.mimeType||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";return d.ZipContainer.getContent(c)},bt=function(e){var t=e.fileName,r=void 0===t?"export.xlsx":t,n=wt(e);n&&d.Downloader.download(r,n)},St=function(e,t){var r="xl/drawings/drawing"+(t+1)+".xml",n="xl/drawings/_rels/drawing"+(t+1)+".xml.rels",o="xl/worksheets/_rels/sheet"+(e+1)+".xml.rels";d.ZipContainer.addFile(n,ft.createDrawingRel(e)),d.ZipContainer.addFile(r,ft.createDrawing(e)),d.ZipContainer.addFile(o,ft.createWorksheetDrawingRel(t))},Mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.exportMode="xlsx",t}return yt(t,e),t.prototype.postConstruct=function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsWrapper:this.gridOptionsWrapper})},t.prototype.getMergedParams=function(e){var t=this.gridOptionsWrapper.getDefaultExportParams("excel");return Object.assign({},t,e)},t.prototype.getData=function(t){return this.setExportMode(t.exportMode||"xlsx"),e.prototype.getData.call(this,t)},t.prototype.export=function(e){if(this.isExportSuppressed())return console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration."),"";var t=this.getMergedParams(e),r=this.getData(t),n={data:[r],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType},o=this.packageFile(n);return o&&d.Downloader.download(this.getFileName(t.fileName),o),r},t.prototype.exportDataAsExcel=function(e){return this.export(e)},t.prototype.getDataAsExcel=function(e){var t=this.getMergedParams(e),r=this.getData(t);if(e&&"xml"===e.exportMode)return r;var n={data:[r],fontSize:t.fontSize,author:t.author,mimeType:t.mimeType};return this.packageFile(n)},t.prototype.setFactoryMode=function(e,t){void 0===t&&(t="xlsx"),("xlsx"===t?ft:E).factoryMode=e},t.prototype.getFactoryMode=function(e){return("xlsx"===e?ft:E).factoryMode},t.prototype.getSheetDataForExcel=function(e){var t=this.getMergedParams(e);return this.getData(t)},t.prototype.getMultipleSheetsAsExcel=function(e){return wt(e)},t.prototype.exportMultipleSheetsAsExcel=function(e){return bt(e)},t.prototype.getDefaultFileName=function(){return"export."+this.getExportMode()},t.prototype.getDefaultFileExtension=function(){return this.getExportMode()},t.prototype.createSerializingSession=function(e){var t=this.columnModel,r=this.valueService,n=this.gridOptionsWrapper,o="xlsx"===this.getExportMode(),a="ag-grid";null!=e.sheetName&&(a=c._.utf8_encode(e.sheetName.toString().substr(0,31)));var i=xt(xt({},e),{sheetName:a,columnModel:t,valueService:r,gridOptionsWrapper:n,headerRowHeight:e.headerRowHeight||e.rowHeight,baseExcelStyles:this.gridOptions.excelStyles||[],styleLinker:this.styleLinker.bind(this)});return new(o?gt:H)(i)},t.prototype.styleLinker=function(e,t,r,n,o){if(e===d.RowType.HEADER)return["header"];if(e===d.RowType.HEADER_GROUPING)return["header","headerGroup"];var a=this.gridOptions.excelStyles,i=["cell"];if(!a||!a.length)return i;var s=a.map((function(e){return e.id}));return this.stylingService.processAllCellClasses(n.getColDef(),{value:r,data:o.data,node:o,colDef:n.getColDef(),rowIndex:t,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),$scope:null,context:this.gridOptionsWrapper.getContext()},(function(e){s.indexOf(e)>-1&&i.push(e)})),i.sort((function(e,t){return s.indexOf(e)<s.indexOf(t)?-1:1}))},t.prototype.isExportSuppressed=function(){return this.gridOptionsWrapper.isSuppressExcelExport()},t.prototype.setExportMode=function(e){this.exportMode=e},t.prototype.getExportMode=function(){return this.exportMode},t.prototype.packageFile=function(e){if("xml"===this.getExportMode()){var t=e.mimeType||"application/vnd.ms-excel";return new Blob(["\ufeff",e.data[0]],{type:t})}return wt(e)},vt([c.Autowired("columnModel")],t.prototype,"columnModel",void 0),vt([c.Autowired("valueService")],t.prototype,"valueService",void 0),vt([c.Autowired("gridOptions")],t.prototype,"gridOptions",void 0),vt([c.Autowired("stylingService")],t.prototype,"stylingService",void 0),vt([c.Autowired("gridSerializer")],t.prototype,"gridSerializer",void 0),vt([c.Autowired("gridOptionsWrapper")],t.prototype,"gridOptionsWrapper",void 0),vt([c.PostConstruct],t.prototype,"postConstruct",null),t=vt([c.Bean("excelCreator")],t)}(d.BaseCreator),Ct={moduleName:c.ModuleNames.ExcelExportModule,beans:[Mt,d.GridSerializer,d.CsvCreator],dependantModules:[d.CsvExportModule,u.EnterpriseCoreModule]};exports.ExcelExportModule=Ct,exports.exportMultipleSheetsAsExcel=bt,exports.getMultipleSheetsAsExcel=wt;